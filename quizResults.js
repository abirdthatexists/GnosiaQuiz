const data = {
    labels: [
        'Charisma',
        'Intuition',
        'Logic',
        'Charm',
        'Performance',
        'Stealth'
    ],
    datasets: [{
        label: 'Results',
        data: [0, 0, 0, 0, 0, 0],
        fill: true,
        backgroundColor: 'rgba(90, 101, 117, 0.2)',
        borderColor: 'rgb(90, 101, 117)',
        pointBackgroundColor: 'rgb(90, 101, 117)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgb(90, 101, 117)'
    }, {
        label: 'Setsu',
        data: [35, 28.5, 38.5, 36.5, 31, 17.5],
        fill: true,
        backgroundColor: 'rgba(49, 159, 154, 0.2)',
        borderColor: 'rgb(49, 159, 154)',
        pointBackgroundColor: 'rgb(49, 159, 154)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgb(49, 159, 154)',
        hidden: true
    }, {
        label: 'Gina',
        data: [17.5, 45.5, 31.5, 24, 13, 31.5],
        fill: true,
        backgroundColor: 'rgba(128, 51, 146, 0.2)',
        borderColor: 'rgb(128, 51, 146)',
        pointBackgroundColor: 'rgb(128, 51, 146)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgb(128, 51, 146)',
        hidden: true
    }, {
        label: 'SQ',
        data: [22, 21.5, 12, 46, 47.5, 38.5],
        fill: true,
        backgroundColor: 'rgba(229, 0, 58, 0.2)',
        borderColor: 'rgba(229, 0, 58)',
        pointBackgroundColor: 'rgba(229, 0, 58)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(229, 0, 58)',
        hidden: true
    }, {
        label: 'Raqio',
        data: [16.5, 0.5, 49.5, 7.5, 35.5, 20.5],
        fill: true,
        backgroundColor: 'rgba(2, 101, 149, 0.2)',
        borderColor: 'rgba(2, 101, 149)',
        pointBackgroundColor: 'rgba(2, 101, 149)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(2, 101, 149)',
        hidden: true
    }, {
        label: 'Stella',
        data: [27, 18, 42, 27.5, 30.5, 29],
        fill: true,
        backgroundColor: 'rgba(2, 167, 77,0.2)',
        borderColor: 'rgb(2, 167, 77)',
        pointBackgroundColor: 'rgb(2, 167, 77)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgb(2, 167, 77)',
        hidden: true
    }, {
        label: 'Shigemichi',
        data: [45.5, 14.5, 9.5, 17.5, 6, 45],
        fill: true,
        backgroundColor: 'rgba(170, 207, 83, 0.2)',
        borderColor: 'rgba(170, 207, 83)',
        pointBackgroundColor: 'rgba(170, 207, 83)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(170, 207, 83)',
        hidden: true
    }, {
        label: 'Chipie',
        data: [25, 39, 18.5, 31, 16.5, 33.5],
        fill: true,
        backgroundColor: 'rgba(244, 152, 28, 0.2)',
        borderColor: 'rgba(244, 152, 28)',
        pointBackgroundColor: 'rgba(244, 152, 28)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(244, 152, 28)',
        hidden: true
    }, {
        label: 'Comet',
        data: [17, 49.5, 0.5, 32.5, 16.5, 22.5],
        fill: true,
        backgroundColor: 'rgba(255, 244, 6, 0.2)',
        borderColor: 'rgba(255, 244, 6)',
        pointBackgroundColor: 'rgba(255, 244, 6)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(255, 244, 6)',
        hidden: true
    }, {
        label: 'Jonas',
        data: [38.5, 25, 34, 21.5, 43.5, 37],
        fill: true,
        backgroundColor: 'rgba(125, 93, 83, 0.2)',
        borderColor: 'rgba(125, 93, 83)',
        pointBackgroundColor: 'rgba(125, 93, 83)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(125, 93, 83)',
        hidden: true
    }, {
        label: 'Kukrushka',
        data: [14, 35.5, 3.5, 49.5, 45, 40.5],
        fill: true,
        backgroundColor: 'rgba(129, 0, 7, 0.2)',
        borderColor: 'rgba(129, 0, 7)',
        pointBackgroundColor: 'rgba(129, 0, 7)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(129, 0, 7)',
        hidden: true
    }, {
        label: 'Otome',
        data: [16, 32, 46.5, 42, 23, 26.5],
        fill: true,
        backgroundColor: 'rgba(250, 220, 235, 0.2)',
        borderColor: 'rgba(250, 220, 235)',
        pointBackgroundColor: 'rgba(250, 220, 235)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(250, 220, 235)',
        hidden: true
    }, {
        label: 'Sha-Ming',
        data: [29, 6.5, 6.5, 34.5, 40.5, 49.5],
        fill: true,
        backgroundColor: 'rgba(35, 23, 23, 0.2)',
        borderColor: 'rgba(35, 23, 23)',
        pointBackgroundColor: 'rgba(35, 23, 23)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(35, 23, 23)',
        hidden: true
    }, {
        label: 'Remnan',
        data: [2, 41, 28, 29, 33, 43.5],
        fill: true,
        backgroundColor: 'rgba(204, 204, 204, 0.2)',
        borderColor: 'rgba(204, 204, 204)',
        pointBackgroundColor: 'rgba(204, 204, 204)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(204, 204, 204)',
        hidden: true
    }, {
        label: 'Yuriko',
        data: [49.5, 42, 44, 37.5, 49.5, 25],
        fill: true,
        backgroundColor: 'rgba(156, 157, 150, 0.2)',
        borderColor: 'rgba(156, 157, 150)',
        pointBackgroundColor: 'rgba(156, 157, 150)',
        pointBorderColor: '#fff',
        pointHoverBackgroundColor: '#fff',
        pointHoverBorderColor: 'rgba(156, 157, 150)',
        hidden: true
    }]
};
var options = {
    scale: {
        r: {
            min: 0,
            max: 50,
        },
        legend: {
            labels: {
                fontColor: "blue",
                fontSize: 18
            }
        },
    }
};


const ctx = document.getElementById('quizResults');

radarChart = new Chart(ctx, {
    type: 'radar',
    data: data,
    options: options
});

function showResults() {
    /* hide quiz questions, update silver key */
    quizContainer.style.display = 'none';
    document.getElementById('percent').innerHTML = `The Silver Key is full.`
    document.getElementById('full-key').style.clipPath = `inset(0% 0 0 0)`;
    document.getElementById('empty-key').style.clipPath =  `inset(100% 0 0 0)`;
    const resContainer = document.getElementById("testresults");

    
    let resultStats = `Your results are: <br>Charisma: ${results[0]}<br>Intuition: ${results[1]}<br>Logic: ${results[2]}<br>Charm: ${results[3]}<br>Performance: ${results[4]}<br>Stealth: ${results[5]}<br><br>`;
    data.datasets[0].data = results;
    /* calculate most similar character */
    let similarCharacter = "";
    let similarCharacterIndex = -1;
    let minDifference = 10000;
    data.datasets.forEach((currentData, currentIndex) => {
        if (currentIndex !== 0) {
            let currentDifference = 0;
            currentData.data.forEach((currentAttribute, currentAttrIndex) => {
                currentDifference += Math.abs(currentAttribute - results[currentAttrIndex]);
            });
            if (currentDifference < minDifference) {
                similarCharacter = currentData.label;
                minDifference = currentDifference;
                if (similarCharacterIndex !== -1) {
                    data.datasets[similarCharacterIndex].hidden = true;
                }
                data.datasets[currentIndex].hidden = false;
                similarCharacterIndex = currentIndex;
            }
        }
    });
    console.log(results)
    resContainer.innerHTML += resultStats+`You are most similar to ${similarCharacter}! <br> ${comparisons[similarCharacterIndex-1]}<br><br>To view other characters' graphs, select their names in the legend.`;
    radarChart.update();
    resultsContainer.style.display = "flex";
}